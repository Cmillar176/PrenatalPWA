<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="permissions-check.html">
<link rel="import" href="create-patient-form.html">
<link rel="import" href="create-hcp-form.html">
<link rel="import" href="warning-form.html">
<dom-module id="create-user">
    <template>
        <permissions-check id="permission-check" is-hcp="{{isHCP}}" is-admin="{{isAdmin}}"></permissions-check>
        <firebase-auth id="auth" app-name="PrenatalPWA"></firebase-auth>
        <!--        hidden if not admin and not a HCP-->
        <create-patient-form id="patient-form" hidden$="{{!isAdmin && !isHCP}}"></create-patient-form>
        <!--        Hidden if not an admin -->
        <create-hcp-form id="hcp-form" hidden$="{{!isAdmin}}"></create-hcp-form>
        <!--        Hidden if you are an admin or HCP-->
        <warning-form id="warning-form" hidden$="{{isAdmin || isHCP}}"></warning-form>
    </template>
    <script>
        Polymer({
            is: 'create-user'
            , listeners: {
                'add-patient': '_addPatient'
                , 'add-hcp': '_addHcp'
                , 'reset-create-form': '_resetCreateForm'
            }
            , _addPatient: function (event) {
                this.$.auth.createUserWithEmailAndPassword(event.detail.patient.email, event.detail.patient.password).then(function () {
                    console.log("User created")
                }).catch(function (error) {
                    console.log("Error creating patient");
                });
            }
            , _addHcp: function (event) {
                this.auth.createUserWithEmailAndPassword(event.details.hcp.email, email.detail.hcp.password).then(function () {
                    console.log("HCP created");
                }).catch(function (error) {
                    console.log("Error creating HCP");
                });
            }
        });
    </script>
</dom-module>